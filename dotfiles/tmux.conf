# General
set -g default-command "exec /bin/bash"
set -g default-terminal "screen-256color"
#  screen-256color  gnome-256color  tmux-256color  xterm-256color
set -g history-limit 10000
set -sg escape-time 0
set -sg repeat-time 1000
setw -g mouse on
set -g renumber-windows on


# Binds
set -g mode-keys vi
set -g status-keys emacs

set -g prefix C-a
bind C-a send-prefix
unbind C-b

# bind Escape copy-mode
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "xclip -in -selection clipboard"
bind v copy-mode\; send -X begin-selection
bind -T copy-mode-vi 'v' send -X begin-selection
bind p run "tmux set-buffer \"$(xclip -o)\"; tmux paste-buffer"
bind -T copy-mode-vi 'y' send-keys -X copy-pipe-and-cancel "xclip -i -f -selection primary | xclip -i -selection clipboard"

# bind h select-pane -L
# bind j select-pane -D
# bind k select-pane -U
# bind l select-pane -R

bind Left  swap-pane -U
bind Down  swap-pane -D
bind Up    swap-pane -U
bind Right swap-pane -D

bind h split-window -h -c "#{pane_current_path}"\; swap-pane -U
bind j split-window -v -c "#{pane_current_path}"
bind k split-window -v -c "#{pane_current_path}"\; swap-pane -U
bind l split-window -h -c "#{pane_current_path}"

bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

bind -n M-1 select-window -t 1
bind -n M-2 select-window -t 2
bind -n M-3 select-window -t 3
bind -n M-4 select-window -t 4
bind -n M-5 select-window -t 5
bind -n M-6 select-window -t 6
bind -n M-7 select-window -t 7
bind -n M-8 select-window -t 8
bind -n M-9 select-window -t 9
bind -n M-0 last-window
bind -n M-- swap-window -t :-
bind -n M-= swap-window -t :+
bind -n M-h select-window -t :-
bind -n M-l select-window -t :+

bind '"' split-window -c "#{pane_current_path}"
bind % split-window -h -c "#{pane_current_path}"
# bind c new-window -c "#{pane_current_path}"

bind r source-file ~/.tmux.conf \; display-message " config reloaded"

bind -r Tab   select-window -t :+
bind -r S-Tab select-window -t :-
# bind & kill-window
bind x kill-pane
bind / command-prompt -p "(search down)" "send -X search-forward \"%%%\""
bind s select-pane -t 2 \; send-keys C-c Enter Up C-m \; last-pane

# Smart pane switching with awareness of Vim splits.
# See: https://github.com/christoomey/vim-tmux-navigator
is_vim="ps -o state= -o comm= -t '#{pane_tty}' \
    | grep -iqE '^[^TXZ ]+ +(\\S+\\/)?g?(view|n?vim?x?)(diff)?$'"
bind -n C-h if-shell "$is_vim" "send-keys C-h"  "select-pane -L"
bind -n C-j if-shell "$is_vim" "send-keys C-j"  "select-pane -D"
bind -n C-k if-shell "$is_vim" "send-keys C-k"  "select-pane -U"
bind -n C-l if-shell "$is_vim" "send-keys C-l"  "select-pane -R"
# bind -n C-\ if-shell "$is_vim" "send-keys C-\\" "select-pane -l"
bind -T copy-mode-vi C-h select-pane -L
bind -T copy-mode-vi C-j select-pane -D
bind -T copy-mode-vi C-k select-pane -U
bind -T copy-mode-vi C-l select-pane -R
# bind -T copy-mode-vi C-\ select-pane -l


# Customization
set  -g base-index 1
setw -g pane-base-index 1
set  -g status-position bottom
set  -g status-right-length 80
set  -g status-left-length 50
set  -g status-justify left
setw -g monitor-activity on
set  -g visual-activity off

set -g status-fg colour250
set -g status-bg colour236
set -g status-interval 5
set -g status-left "#[fg=colour234]#[bg=colour104] #S #[bg=default]  "
set -g status-left-attr bold
set -g window-status-separator ' '
set -g status-right-attr none
set -g status-right ''

setw -g mode-style bg=colour237,fg=colour252,bold
setw -g window-status-fg colour252
setw -g window-status-bg default
setw -g window-status-attr none
setw -g window-status-current-fg colour16
setw -g window-status-current-bg default
setw -g window-status-current-attr bold
setw -g window-status-activity-bg colour237
setw -g window-status-activity-fg default
setw -g window-status-activity-attr none

set -g message-fg colour110
set -g message-bg colour236
set -g message-attr bold
set -g message-command-fg colour255
set -g message-command-bg default
set -g message-command-attr bold

set -g pane-border-fg colour110
set -g pane-active-border-fg colour113

setw -g window-status-format         ' #[fg=colour234]#[bg=colour250] #I #[fg=colour250]#[bg=default] #W '
setw -g window-status-current-format ' #[fg=colour234]#[bg=colour117] #I #[fg=colour117]#[bg=default] #W '

if-shell -b '[ "$HOSTNAME" = estor ]' \
    "set -g status-left '#[fg=colour234]#[bg=colour113] #S #[bg=default]  '; \
     set -g status-right ''"
     # set -g status-right '#(~/myconfig/dotfiles/tmux_status)'"

# Also, change some visual styles when window keys are off
bind -T root F12  \
         set prefix None \;\
         set key-table off \;\
         set -g status-left '#[fg=colour234]#[bg=colour113] #S #[bg=colour208] (rmt) #[bg=default]  '\;\
         if -F '#{pane_in_mode}' 'send-keys -X cancel' \;\
         refresh-client -S \;\

bind -T off F12 \
         set -u prefix \;\
         set -u key-table \;\
         set -g status-left '#[fg=colour234]#[bg=colour113] #S #[bg=default]  '\;\
         refresh-client -S

